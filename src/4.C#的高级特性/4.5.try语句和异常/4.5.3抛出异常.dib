#!meta

{"kernelInfo":{"defaultKernelName":"csharp","items":[{"aliases":[],"name":"csharp"}]}}

#!csharp

/*
    4.5.3 æŠ›å‡ºå¼‚å¸¸
    è¿è¡Œæ—¶æˆ–ç”¨æˆ·ä»£ç éƒ½å¯ä»¥æŠ›å‡ºå¼‚å¸¸ã€‚
*/

//ä»¥ä¸‹ä¾‹å­ä¸­ï¼ŒDisplayæ–¹æ³•ä¼šæŠ›å‡ºSystem.ArgumentNullExceptionï¼š
void Display(string name)
{
    if (name == null)
    {
        throw new ArgumentNullException(nameof(name));
    }

    Console.WriteLine(name);
}

try
{
    Display(null);
}
catch (ArgumentNullException ex)
{
    Console.WriteLine(ex.Message);
}

#!csharp

/*
    4.5.3.1 throwè¡¨è¾¾å¼ï¼ˆC# 7ï¼‰
*/

//åœ¨C# 7ä¹‹å‰ï¼Œthrowæ°¸è¿œæ˜¯ä¸€ä¸ªè¯­å¥ï¼Œè€Œç°åœ¨å®ƒä¹Ÿå¯ä»¥ä»¥è¡¨è¾¾å¼çš„å½¢å¼å‡ºç°åœ¨è¡¨è¾¾å¼å‡½æ•°ä¸­ï¼š
public string Foo() => throw new NotImplementedException();

//throwè¡¨è¾¾å¼ä¹Ÿå¯ä»¥å‡ºç°åœ¨ä¸‰å…ƒæ¡ä»¶è¡¨è¾¾å¼ä¸­ï¼š
string ProperCase(string value) =>
  value == null ? throw new ArgumentException("value") :
  value == "" ? "" :
  char.ToUpper(value[0]) + value.Substring(1);

#!csharp

/*
    4.5.3.2 é‡æ–°æŠ›å‡ºå¼‚å¸¸
*/

//å¯ä»¥æ•è·å¼‚å¸¸åå†é‡æ–°æŠ›å‡ºï¼Œä¾‹å¦‚ï¼š
try
{
    //...
}
catch (Exception ex)
{
    // Log error
    //...
    throw;            // Rethrow same exception
}

#!csharp

/*
    ğŸ¦å¦‚æœå°†throwæ›¿æ¢ä¸ºthrow exï¼Œé‚£ä¹ˆè¿™ä¸ªä¾‹å­ä»ç„¶æœ‰æ•ˆã€‚
    ä½†æ˜¯æ–°äº§ç”Ÿå¼‚å¸¸çš„StackTraceå±æ€§ä¸å†åæ˜ åŸå§‹çš„é”™è¯¯ã€‚
*/

//é‡æ–°æŠ›å‡ºå¼‚å¸¸å¯ç”¨äºéœ€è¦è®°å½•é”™è¯¯ä½†æ˜¯å¹¶ä¸å°†å¼‚å¸¸éšè—çš„æƒ…å½¢ï¼Œä¹Ÿå¯ä»¥åœ¨å¼‚å¸¸è¶…å‡ºå¤„ç†èŒƒå›´çš„æƒ…å†µä¸‹æ”¾å¼ƒå¯¹å¼‚å¸¸è¿›è¡Œå¤„ç†ã€‚
using System.Net;        // (See Chapter 16)

string s = null;
using (WebClient wc = new WebClient())
    try
    {
        s = wc.DownloadString("http://www.albahari.com/nutshell/");
    }
    catch (WebException ex)
    {
        if (ex.Status == WebExceptionStatus.Timeout)
            Console.WriteLine("Timeout");
        else
            throw;      // Can't handle other sorts of WebException, so rethrow
    }

#!csharp

/*
    ä»C# 6.0å¼€å§‹ï¼Œä¸Šè¿°ä¾‹å­å¯ä»¥ä½¿ç”¨å¼‚å¸¸ç­›é€‰å™¨ç®€å†™æˆï¼š
    catch (WebException ex) when (ex.Status == WebExceptionStatus.Timeout)
    {
        Console.WriteLine ("Timeout");
    }
*/

#!csharp

//å¦ä¸€ç§å¸¸è§æƒ…å½¢æ˜¯é‡æ–°æŠ›å‡ºæŸä¸ªæ˜ç¡®ç±»å‹çš„å¼‚å¸¸ï¼Œä¾‹å¦‚ï¼š
using System.Xml;

try
{
    //... // Parse a DateTime from XML element data
}
catch (FormatException ex)
{
    throw new XmlException("Invalid DateTime", ex);
}

#!csharp

/*
    è¯·æ³¨æ„ï¼Œå½“æ„å»ºXmlExceptionæ—¶ï¼Œæˆ‘ä»¬å°†åŸå§‹çš„å¼‚å¸¸exä½œä¸ºç¬¬äºŒä¸ªå‚æ•°ã€‚
    è¿™ä¸ªå‚æ•°å°†ä½œä¸ºæ–°å¼‚å¸¸çš„InnerExceptionå±æ€§è€Œè¾…åŠ©è¯Šæ–­ã€‚
    å‡ ä¹æ‰€æœ‰ç±»å‹çš„å¼‚å¸¸éƒ½æä¾›äº†ç±»ä¼¼çš„æ„é€ å™¨ã€‚
*/

/*
    åœ¨è·¨è¶Šä¿¡ä»»è¾¹ç•Œæ—¶ï¼Œå¸¸ç”¨åšæ³•æ˜¯é‡æ–°æŠ›å‡ºä¸€ä¸ªä¸é‚£ä¹ˆæ˜ç¡®çš„å¼‚å¸¸ï¼Œä»¥é˜²æ­¢æŠ€æœ¯ä¿¡æ¯æ³„éœ²è€Œç»™é»‘å®¢å¯ä¹˜ä¹‹æœºã€‚
*/

#!meta

{"kernelInfo":{"defaultKernelName":"csharp","items":[{"aliases":[],"name":"csharp"}]}}

#!csharp

/*
    4.13.5 åŠ¨æ€ç±»å‹çš„è¿è¡Œæ—¶è¡¨ç¤º
    dynamicå’Œobjectç±»å‹ä¹‹é—´æœ‰æ·±åº¦çš„ç­‰ä»·å…³ç³»ã€‚
*/

// åœ¨è¿è¡Œæ—¶ï¼Œä»¥ä¸‹çš„è¡¨è¾¾å¼çš„ç»“æœä¸ºtrueï¼š
Console.WriteLine(typeof(dynamic) == typeof(object));

#!csharp

// ä¸Šè¿°è§„åˆ™è¿˜å¯ä»¥æ‰©å±•åˆ°æ„é€ ç±»å‹å’Œæ•°ç»„ç±»å‹ï¼š
Console.WriteLine(typeof(List<dynamic>) == typeof(List<object>));
Console.WriteLine(typeof(dynamic[]) == typeof(object[]));

#!csharp

// ä¸å¯¹è±¡å¼•ç”¨ç›¸ä¼¼ï¼ŒåŠ¨æ€å¼•ç”¨ä¹Ÿå¯ä»¥æŒ‡å‘é™¤æŒ‡é’ˆç±»å‹ä»¥å¤–çš„ä»»ä½•ç±»å‹çš„å¯¹è±¡ï¼š
dynamic x = "hello";
Console.WriteLine(x.GetType().Name);  // String

x = 123;  // No error (despite same variable)
Console.WriteLine(x.GetType().Name);  // Int32

#!csharp

/*
    åœ¨ç»“æ„ä¸Šï¼Œobjectå¼•ç”¨å’ŒåŠ¨æ€å¼•ç”¨æ²¡æœ‰ä»»ä½•åŒºåˆ«ã€‚
    åŠ¨æ€å¼•ç”¨å¯ä»¥ç›´æ¥åœ¨å®ƒæ‰€æŒ‡å‘çš„å¯¹è±¡ä¸Šæ‰§è¡ŒåŠ¨æ€æ“ä½œã€‚
    å¯ä»¥å°†objectå¯¹è±¡è½¬æ¢ä¸ºdynamicï¼Œä»¥ä¾¿å¯¹objectå¯¹è±¡æ‰§è¡Œä»»æ„çš„åŠ¨æ€æ“ä½œï¼š
*/

object o = new System.Text.StringBuilder();
dynamic d = o;
d.Append("hello");
Console.WriteLine(o);    // hello

#!csharp

/*
    ğŸ¦ è‹¥åœ¨ä¸€ä¸ªæä¾›äº†å…¬å¼€çš„dynamicæˆå‘˜çš„ç±»å‹ä¸Šä½¿ç”¨åå°„ï¼Œå°±å¯ä»¥è§‚å¯Ÿåˆ°è¿™äº›æˆå‘˜å°±æ˜¯æ ‡è®°äº†ç‰¹æ€§çš„objectã€‚
*/

public class Test
{
    public dynamic Foo;
}

#!csharp

// ç­‰ä»·çš„ã€‚
public class Test
{
    [System.Runtime.CompilerServices.DynamicAttribute]
    public object Foo;
}

// è¿™ä»¤è¯¥ç±»å‹çš„æ¶ˆè´¹è€…çŸ¥é“Fooå±æ€§åº”è¯¥ä½œä¸ºåŠ¨æ€ç±»å‹ä½¿ç”¨ï¼Œè€ŒåŒæ—¶ä¹Ÿå¯ä»¥åœ¨ä¸æ”¯æŒåŠ¨æ€ç»‘å®šçš„è¯­è¨€ä¸Šå›é€€åˆ°objectç±»å‹ã€‚
